{
  "comments": [
    {
      "key": {
        "uuid": "5ad0253b_2d9b78cb",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1458,
      "author": {
        "id": 1000045
      },
      "writtenOn": "2018-06-18T07:38:09Z",
      "side": 1,
      "message": "Maybe we can avoid creating a file here? we need just version here so can use a pipeline",
      "range": {
        "startLine": 1458,
        "startChar": 28,
        "endLine": 1458,
        "endChar": 44
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_cd808449",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1458,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2018-06-18T07:54:04Z",
      "side": 1,
      "message": "I am trying to avoid long-long and unreadable line.",
      "parentUuid": "5ad0253b_2d9b78cb",
      "range": {
        "startLine": 1458,
        "startChar": 28,
        "endLine": 1458,
        "endChar": 44
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_8d484c2f",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1461,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-06-18T08:30:06Z",
      "side": 1,
      "message": "Some tools refuse to act if there\u0027s no .gz (or whatever) prefix.  I suppose that you know that zcat works or you checked explicitly, but just in case.",
      "range": {
        "startLine": 1461,
        "startChar": 28,
        "endLine": 1461,
        "endChar": 54
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_2d5ed8e9",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1461,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2018-06-18T08:44:07Z",
      "side": 1,
      "message": "Tnx, I have tested it on PPA without installer https://paste.mgm.sipwise.com/show/4129/\n\nI will repeat the test on PPA with installer.",
      "parentUuid": "5ad0253b_8d484c2f",
      "range": {
        "startLine": 1461,
        "startChar": 28,
        "endLine": 1461,
        "endChar": 54
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_6d03b0b9",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1461,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-06-18T09:45:52Z",
      "side": 1,
      "message": "Also, another idea.\n\nNot fully sure what the sed line is trying to do, but if it\u0027s extracting the version of \"ngcp-installer\", consider this example:\n\n  m$ packages_file\u003d/var/lib/apt/lists/deb.debian.org_debian_dists_stretch_main_binary-amd64_Packages\n\n  $ installer_package\u003daptitude\n\n  $ cat \"${packages_file}\" | sed -n \"/^Package: ${installer_package}$/,/^Version: / s|^Version: ||p\"\n0.8.7-1\n\nWhat it does is to take the section of the file starting with \"Package: $installer\" (using aptitude as example :-P) until the next Version field (which should be after it, and it should be the version of the package and not for other package).\n\nAlso in this way, it\u0027s easier to use with the \"wget\" in the same line:\n\n  $ wget --timeout\u003d30 -O - \"${ppa_repos_base_path}/Packages.gz\" | gzip -dc | sed -n \"/^Package: ${installer_package}$/,/^Version: / s|^Version: ||p\"\n\n\nHope that helps.\n\n(But for me, your version is fine too, so it\u0027s just an idea).",
      "parentUuid": "5ad0253b_2d5ed8e9",
      "range": {
        "startLine": 1461,
        "startChar": 28,
        "endLine": 1461,
        "endChar": 54
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_2d2c9849",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1461,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2018-06-18T09:49:02Z",
      "side": 1,
      "message": "I am afraid your\u0027s version will mask downloading errors and the result will be thread as \"missing version\" in Packages.gz file -\u003e not using PPA. We do not have \"pipefail\" here historically.",
      "parentUuid": "5ad0253b_6d03b0b9",
      "range": {
        "startLine": 1461,
        "startChar": 28,
        "endLine": 1461,
        "endChar": 54
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_2dd3783a",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1461,
      "author": {
        "id": 1000042
      },
      "writtenOn": "2018-06-18T10:06:09Z",
      "side": 1,
      "message": "\u003e I am afraid your\u0027s version will mask downloading errors and the\n \u003e result will be thread as \"missing version\" in Packages.gz file -\u003e\n \u003e not using PPA. We do not have \"pipefail\" here historically.\n\nThat\u0027s right.  Let\u0027s go with your submitted version then :-)",
      "parentUuid": "5ad0253b_2d2c9849",
      "range": {
        "startLine": 1461,
        "startChar": 28,
        "endLine": 1461,
        "endChar": 54
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_ad954841",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1461,
      "author": {
        "id": 1000016
      },
      "writtenOn": "2018-06-18T10:47:50Z",
      "side": 1,
      "message": "Hmm actually, have you considered using apt-get download directly instead of all this mucking around with fetching and parsing Packages and similar? (BTW while it\u0027s normally the case I think the assumption that the Package field is the first one is bogus :).\n\nWith apt it would be a matter of configuring one or more sources and then requesting the specific version or just pin the them with appropriate priorities and then using the unversioned name.",
      "parentUuid": "5ad0253b_2dd3783a",
      "range": {
        "startLine": 1461,
        "startChar": 28,
        "endLine": 1461,
        "endChar": 54
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_ed34604b",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1461,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2018-06-18T11:25:55Z",
      "side": 1,
      "message": "Yes I did, while first we need to polish here sipwise.gpg installation (using ngcp-keyring). At the moment it is a copy of the next line 1477.\n\nP.S. if you check ngcp-installer, we use --allow-unauthenticated for keyring installation , which is horrible as well :(\n\nStep-by-step. the commit here is to address regression for PPA usage and we will continue cleanup here for sure ;-)",
      "parentUuid": "5ad0253b_ad954841",
      "range": {
        "startLine": 1461,
        "startChar": 28,
        "endLine": 1461,
        "endChar": 54
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_2d7938fd",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1461,
      "author": {
        "id": 1000001
      },
      "writtenOn": "2018-06-18T11:39:55Z",
      "side": 1,
      "message": "BTW, can you share the good code example of \"apt-get download directly\" here?",
      "parentUuid": "5ad0253b_ed34604b",
      "range": {
        "startLine": 1461,
        "startChar": 28,
        "endLine": 1461,
        "endChar": 54
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5ad0253b_ed43406b",
        "filename": "templates/scripts/includes/deployment.sh",
        "patchSetId": 3
      },
      "lineNbr": 1461,
      "author": {
        "id": 1000016
      },
      "writtenOn": "2018-06-18T13:54:35Z",
      "side": 1,
      "message": "There are several ways we could do this. One could be to configure a temporary sources.list for the PPA (either in $ROOT/etc or in a $TMP/etc/apt/ dir, update and install from there.\n\nThe other more manual way, but probably better than what we have here would be to download the Packages file and pass it to apt-get install or apt-get download using --with-source Packges.gz or similar. Then we should not need to check the version string etc.",
      "parentUuid": "5ad0253b_2d7938fd",
      "range": {
        "startLine": 1461,
        "startChar": 28,
        "endLine": 1461,
        "endChar": 54
      },
      "revId": "6a83aee5570897ba55a5973f3e6292d493504515",
      "serverId": "85315e57-5f03-49c3-83f8-201ae2313a75",
      "unresolved": false
    }
  ]
}